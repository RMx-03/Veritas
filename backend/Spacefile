# Deta Space configuration
v: 0
micros:
  - name: veritas-api
    src: .
    engine: python3.9
    primary: true
    run: uvicorn main:app
    dev: uvicorn main:app --reload
    presets:
      env:
        - name: GROQ_API_KEY
          description: "Groq API key for AI analysis"
          default: ""
        - name: GROQ_BASE_URL
          description: "Groq OpenAI-compatible base URL"
          default: "https://api.groq.com/openai/v1"
        - name: GROQ_MODEL
          description: "Groq model id (e.g., deepseek-r1-distill-llama-70b)"
          default: "deepseek-r1-distill-llama-70b"
        - name: HUGGINGFACE_API_KEY  
          description: "HuggingFace API key for OCR (DocTR via Inference API)"
          default: ""
        
        - name: SUPABASE_URL
          description: "Supabase project URL"
          default: ""
        - name: SUPABASE_ANON_KEY
          description: "Supabase anonymous key"
          default: ""
        - name: USDA_API_KEY
          description: "USDA API key (optional)"
          default: ""
        - name: OPENFOODFACTS_BASE_URL
          description: "OpenFoodFacts product API base URL"
          default: "https://world.openfoodfacts.org/api/v0/product/"
        - name: DOCTR_API_MODEL
          description: "DocTR model id for HF Inference API OCR"
          default: "microsoft/trocr-small-printed"
        - name: ALLOWED_ORIGINS
          description: "Comma-separated allowed origins for CORS (use '*' only in development)"
          default: "*"
        - name: MAX_UPLOAD_MB
          description: "Max upload size in MB for /analyze"
          default: "10"
        - name: RATE_LIMIT_PER_MINUTE
          description: "Per-IP requests per minute limit"
          default: "120"
        - name: WARMUP_ON_STARTUP
          description: "Warm up OCR engines on startup (true/false)"
          default: "true"
